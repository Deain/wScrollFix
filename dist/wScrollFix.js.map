{"version":3,"file":"wScrollFix.js","sources":["../lib/scrollFix.js"],"sourcesContent":["let clearTimeoutHandler = 0;\n\nfunction bindContainerListLoadEvent (elem) {\n  let observer = new MutationObserver(function (mutations) {\n    mutations.forEach(function () {\n      clearTimeout(clearTimeoutHandler);\n      clearTimeoutHandler = setTimeout(() => {\n        if (elem.scrollTop == 0) {\n          elem.scrollTop = 1;\n        }\n      }, 100);\n    });\n  });\n  observer.observe(elem, {attributes: true, childList: true, characterData: true, subtree: true});\n}\n\n\nfunction bindScrollFixEvent (elem) {\n\n  elem.scrollTop = 1;\n\n  elem.addEventListener('touchstart', function (event) {\n    let startTopScroll = elem.scrollTop;\n    if (startTopScroll <= 0) {\n      elem.scrollTop = 1;\n    }\n    if (startTopScroll + elem.offsetHeight >= elem.scrollHeight) {\n      elem.scrollTop = elem.scrollHeight - elem.offsetHeight - 1;\n    }\n  }, false);\n\n  elem.addEventListener(\"scroll\", e => {\n      let target = e.target;\n      if (target.scrollTop == 0) {\n        target.scrollTop = 1;\n      } else if (target.scrollTop + target.offsetHeight == target.scrollHeight) {\n        target.scrollTop = target.scrollTop - 1;\n      }\n    }\n  );\n\n  elem.addEventListener(\"touchmove\", e => {\n    if (e.currentTarget.offsetHeight < e.currentTarget.scrollHeight) {\n      e.stopPropagation();\n    }\n  });\n\n}\n\nfunction errorHandler (msg) {\n  throw new Error(msg);\n}\n\nfunction checkEl (elem) {\n  if (elem) {\n    if (typeof elem === \"string\") {\n      elem = document.querySelector(elem);\n      if (!elem) {\n        errorHandler(\"the element selector is empty result\");\n        return void 0;\n      }\n    } else {\n      return elem;\n    }\n  } else {\n    errorHandler(\"please pass the element\");\n    return void 0;\n  }\n}\n\nexport default function (elem, hasAsyncLoad = false) {\n  elem = checkEl(elem);\n  hasAsyncLoad && bindContainerListLoadEvent(elem);\n  bindScrollFixEvent(elem);\n};"],"names":[],"mappings":";;;;;;AAAA,IAAI,mBAAmB,GAAG,CAAC,CAAC;;AAE5B,SAAS,0BAA0B,EAAE,IAAI,EAAE;EACzC,IAAI,QAAQ,GAAG,IAAI,gBAAgB,CAAC,UAAU,SAAS,EAAE;IACvD,SAAS,CAAC,OAAO,CAAC,YAAY;MAC5B,YAAY,CAAC,mBAAmB,CAAC,CAAC;MAClC,mBAAmB,GAAG,UAAU,CAAC,MAAM;QACrC,IAAI,IAAI,CAAC,SAAS,IAAI,CAAC,EAAE;UACvB,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;SACpB;OACF,EAAE,GAAG,CAAC,CAAC;KACT,CAAC,CAAC;GACJ,CAAC,CAAC;EACH,QAAQ,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC,UAAU,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC;CACjG;;;AAGD,SAAS,kBAAkB,EAAE,IAAI,EAAE;;EAEjC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;;EAEnB,IAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE,UAAU,KAAK,EAAE;IACnD,IAAI,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC;IACpC,IAAI,cAAc,IAAI,CAAC,EAAE;MACvB,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;KACpB;IACD,IAAI,cAAc,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,EAAE;MAC3D,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;KAC5D;GACF,EAAE,KAAK,CAAC,CAAC;;EAEV,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,CAAC,IAAI;MACjC,IAAI,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC;MACtB,IAAI,MAAM,CAAC,SAAS,IAAI,CAAC,EAAE;QACzB,MAAM,CAAC,SAAS,GAAG,CAAC,CAAC;OACtB,MAAM,IAAI,MAAM,CAAC,SAAS,GAAG,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,YAAY,EAAE;QACxE,MAAM,CAAC,SAAS,GAAG,MAAM,CAAC,SAAS,GAAG,CAAC,CAAC;OACzC;KACF;GACF,CAAC;;EAEF,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,CAAC,IAAI;IACtC,IAAI,CAAC,CAAC,aAAa,CAAC,YAAY,GAAG,CAAC,CAAC,aAAa,CAAC,YAAY,EAAE;MAC/D,CAAC,CAAC,eAAe,EAAE,CAAC;KACrB;GACF,CAAC,CAAC;;CAEJ;;AAED,SAAS,YAAY,EAAE,GAAG,EAAE;EAC1B,MAAM,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC;CACtB;;AAED,SAAS,OAAO,EAAE,IAAI,EAAE;EACtB,IAAI,IAAI,EAAE;IACR,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;MAC5B,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;MACpC,IAAI,CAAC,IAAI,EAAE;QACT,YAAY,CAAC,sCAAsC,CAAC,CAAC;QACrD,OAAO,KAAK,CAAC,CAAC;OACf;KACF,MAAM;MACL,OAAO,IAAI,CAAC;KACb;GACF,MAAM;IACL,YAAY,CAAC,yBAAyB,CAAC,CAAC;IACxC,OAAO,KAAK,CAAC,CAAC;GACf;CACF;;AAED,gBAAe,UAAU,IAAI,EAAE,YAAY,GAAG,KAAK,EAAE;EACnD,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;EACrB,YAAY,IAAI,0BAA0B,CAAC,IAAI,CAAC,CAAC;EACjD,kBAAkB,CAAC,IAAI,CAAC,CAAC;CAC1B;;;;;;;;"}